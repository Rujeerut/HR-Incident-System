<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>HR Incident Reporting System - BJC Big C</title>
  <!-- Tailwind via CDN (works on GitHub Pages) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Fonts: Prompt -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --brand-blue-600:#2563eb;
      --brand-blue-700:#1d4ed8;
      --brand-purple-600:#7c3aed;
      --brand-pink-600:#db2777;
    }
    html, body { font-family: 'Prompt', sans-serif; }

    /* Custom step styles */
    .step-indicator { transition: all .25s ease; }
    .step-indicator.active {
      background: linear-gradient(135deg, #3B82F6, #1D4ED8);
      color:#fff;
    }
    .step-indicator.completed {
      background: linear-gradient(135deg, #10B981, #059669);
      color:#fff;
    }

    /* Card hover */
    .card-hover { transition: transform .2s ease, box-shadow .2s ease; }
    .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0,0,0,.1); }

    /* Appear animations */
    .fade-in { animation: fadeIn .5s ease-in; }
    @keyframes fadeIn { from{opacity:0; transform: translateY(20px)} to{opacity:1; transform: translateY(0)} }
    .floating-element { animation: float 6s ease-in-out infinite }
    @keyframes float { 0%,100%{ transform: translateY(0) rotate(0)} 50%{ transform: translateY(-18px) rotate(180deg)} }

    /* Priority accents */
    .priority-critical { border-left: 6px solid #EF4444 }
    .priority-medium { border-left: 6px solid #F59E0B }
    .priority-low { border-left: 6px solid #10B981 }
  </style>
</head>
<body class="bg-gradient-to-br from-gray-50 to-blue-50 min-h-screen">
  <!-- Top Navigation -->
  <nav class="bg-white shadow-lg border-b-4 border-blue-600">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center gap-4">
          <img src="https://i.postimg.cc/B6wpk3yh/cropped-Logo-BJC-Big-C-2021-2048x606.png" alt="BJC Big C Logo" class="h-12" />
          <div>
            <h1 class="text-2xl font-bold text-gray-800">HR Incident Reporting</h1>
            <p class="text-sm text-gray-600">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</p>
          </div>
        </div>
        <div class="flex gap-2">
          <button onclick="showPage('report')" class="px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</button>
          <button onclick="showPage('history')" class="px-5 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">History</button>
          <button onclick="showPage('dashboard')" class="px-5 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-semibold">Dashboard</button>
          <button onclick="showHRBPLogin()" class="px-5 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold">üîê HRBP</button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Report Page -->
  <main id="reportPage" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Stepper -->
    <div class="flex items-center justify-center mb-8">
      <div class="flex items-center gap-4">
        <div id="step1" class="step-indicator active w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg">1</div>
        <div class="w-16 h-1 bg-gray-300"></div>
        <div id="step2" class="step-indicator w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center font-bold text-lg">2</div>
        <div class="w-16 h-1 bg-gray-300"></div>
        <div id="step3" class="step-indicator w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center font-bold text-lg">3</div>
        <div class="w-16 h-1 bg-gray-300"></div>
        <div id="step4" class="step-indicator w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center font-bold text-lg">4</div>
      </div>
    </div>

    <!-- Step 1: Intro -->
    <section id="introStep" class="fade-in relative">
      <div class="absolute inset-0 overflow-hidden pointer-events-none">
        <div class="floating-element absolute top-10 left-10 w-12 h-12 bg-blue-200 rounded-full opacity-20"></div>
        <div class="floating-element absolute top-20 right-20 w-10 h-10 bg-purple-200 rounded-full opacity-30" style="animation-delay:1s"></div>
        <div class="floating-element absolute bottom-20 left-20 w-8 h-8 bg-pink-200 rounded-full opacity-25" style="animation-delay:2s"></div>
        <div class="floating-element absolute bottom-10 right-10 w-14 h-14 bg-indigo-200 rounded-full opacity-20" style="animation-delay:.5s"></div>
      </div>

      <div class="relative max-w-4xl mx-auto text-center">
        <div class="relative mb-6">
          <div class="w-20 h-20 bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-xl animate-pulse">
            <div class="w-14 h-14 bg-white rounded-full flex items-center justify-center shadow-inner">
              <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
              </svg>
            </div>
          </div>
        </div>

        <h1 class="text-4xl font-extrabold leading-tight mb-3">
          <span class="bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-clip-text text-transparent">‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</span><br />
          <span class="bg-gradient-to-r from-indigo-600 via-blue-600 to-cyan-600 bg-clip-text text-transparent">‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</span>
        </h1>
        <p class="text-lg text-gray-600">HR Incident Reporting System</p>
        <p class="text-sm text-gray-500 mb-6">‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏á‡πà‡∏≤‡∏¢</p>

        <button onclick="nextStep()" class="group relative bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 hover:from-blue-700 hover:via-purple-700 hover:to-pink-700 text-white font-bold py-4 px-8 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 text-lg transform hover:scale-105 hover:-translate-y-1 w-full sm:w-auto">
          <span class="relative z-10 inline-flex items-center">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
            <svg class="w-6 h-6 ml-3 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/></svg>
          </span>
          <span class="absolute inset-0 bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 rounded-2xl blur-xl opacity-30 group-hover:opacity-50"></span>
        </button>
      </div>
    </section>

    <!-- Step 2: Category selection -->
    <section id="categoryStep" class="hidden fade-in">
      <div class="text-center mb-4">
        <h2 class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á</h2>
        <p class="text-sm text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á</p>
      </div>
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 max-w-4xl mx-auto">
        <!-- Termination -->
        <button class="card-hover bg-gradient-to-br from-white to-red-50 rounded-xl shadow-lg p-4 border border-red-100 hover:border-red-300 hover:shadow-xl text-left" onclick="selectCategory('termination')">
          <div class="text-center">
            <div class="w-12 h-12 bg-gradient-to-br from-red-400 to-red-600 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
            </div>
            <h3 class="text-base font-bold text-gray-800 mb-1">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á</h3>
            <p class="text-xs text-gray-600">Termination</p>
            <p class="text-xs text-gray-500">‡∏•‡∏≤‡∏≠‡∏≠‡∏Å, ‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á, ‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢</p>
          </div>
        </button>
        <!-- Accident -->
        <button class="card-hover bg-gradient-to-br from-white to-orange-50 rounded-xl shadow-lg p-4 border border-orange-100 hover:border-orange-300 hover:shadow-xl text-left" onclick="selectCategory('accident')">
          <div class="text-center">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01M5.062 19h13.876c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.33 16.5c-.77.833.192 2.5 1.732 2.5z"/></svg>
            </div>
            <h3 class="text-base font-bold text-gray-800 mb-1">‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏</h3>
            <p class="text-xs text-gray-600">Accident</p>
            <p class="text-xs text-gray-500">‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö, ‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏ô‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</p>
          </div>
        </button>
        <!-- Safety -->
        <button class="card-hover bg-gradient-to-br from-white to-yellow-50 rounded-xl shadow-lg p-4 border border-yellow-100 hover:border-yellow-300 hover:shadow-xl text-left" onclick="selectCategory('safety')">
          <div class="text-center">
            <div class="w-12 h-12 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
            </div>
            <h3 class="text-base font-bold text-gray-800 mb-1">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</h3>
            <p class="text-xs text-gray-600">Safety</p>
            <p class="text-xs text-gray-500">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô, ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p>
          </div>
        </button>
        <!-- Complaint -->
        <button class="card-hover bg-gradient-to-br from-white to-purple-50 rounded-xl shadow-lg p-4 border border-purple-100 hover:border-purple-300 hover:shadow-xl text-left" onclick="selectCategory('complaint')">
          <div class="text-center">
            <div class="w-12 h-12 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl flex items-center justify-center mx-auto mb-3 shadow-lg">
              <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/></svg>
            </div>
            <h3 class="text-base font-bold text-gray-800 mb-1">‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
            <p class="text-xs text-gray-600">Complaint</p>
            <p class="text-xs text-gray-500">‡∏Ç‡πâ‡∏≠‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô, ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞</p>
          </div>
        </button>
      </div>
    </section>

    <!-- Step 3: Sub-category -->
    <section id="subCategoryStep" class="hidden fade-in">
      <div class="text-center mb-6">
        <button onclick="goBackToCategory()" class="mb-4 px-4 py-2 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50 text-sm">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡∏•‡∏±‡∏Å</button>
        <h2 id="subCategoryTitle" class="text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡πà‡∏≠‡∏¢</h2>
        <p class="text-sm text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</p>
      </div>
      <div id="subCategoryCards" class="grid grid-cols-2 gap-4 max-w-3xl mx-auto"></div>
    </section>

    <!-- Step 4: Details form -->
    <section id="detailsStep" class="hidden fade-in">
      <div class="bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-xl p-4 border border-gray-100">
        <div class="flex items-center mb-4">
          <div id="priorityIcon" class="w-8 h-8 rounded-xl mr-3 shadow-md"></div>
          <div>
            <h2 id="formTitle" class="text-lg font-bold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á</h2>
            <p id="formSubtitle" class="text-xs text-gray-600 mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô</p>
          </div>
        </div>
        <form onsubmit="submitReport(event)">
          <!-- Date / Time -->
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4">
            <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
              <div class="flex items-center justify-between mb-2">
                <label class="block text-blue-800 font-semibold text-xs">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏à‡πâ‡∏á</label>
                <button type="button" id="editDateBtn" onclick="toggleDateEdit()" class="text-xs text-blue-600 hover:text-blue-800 underline">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              </div>
              <input type="date" id="reportDate" readonly class="w-full px-3 py-2 bg-white border border-blue-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" />
            </div>
            <div class="bg-blue-50 rounded-lg p-3 border border-blue-200">
              <div class="flex items-center justify-between mb-2">
                <label class="block text-blue-800 font-semibold text-xs">üïê ‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏à‡πâ‡∏á</label>
                <button type="button" id="editTimeBtn" onclick="toggleTimeEdit()" class="text-xs text-blue-600 hover:text-blue-800 underline">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
              </div>
              <input type="time" id="reportTime" readonly class="w-full px-3 py-2 bg-white border border-blue-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" />
            </div>
          </div>

          <!-- Reporter info (demo autofill) -->
          <div class="bg-gray-50 rounded-lg p-4 mb-4 border border-gray-200">
            <h3 class="text-sm font-bold text-gray-800 mb-3 flex items-center">
              <svg class="w-4 h-4 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
              ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <div>
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                <input type="text" id="employeeName" readonly class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" value="‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ" />
              </div>
              <div>
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
                <input type="text" id="employeeCode" readonly class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" value="1234" />
              </div>
              <div>
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡πÅ‡∏ú‡∏ô‡∏Å/‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô</label>
                <input type="text" id="employeeDept" readonly class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" value="‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï" />
              </div>
              <div>
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                <input type="tel" id="employeePhone" readonly class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" value="081-234-5678" />
              </div>
              <div class="sm:col-span-2">
                <label class="block text-gray-700 font-semibold mb-1 text-xs">HR Business Partner ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</label>
                <input type="text" id="assignedHRBP" readonly class="w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed text-sm" value="‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡πÄ‡∏û‡πá‡∏ç - ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á" />
              </div>
            </div>
          </div>

          <!-- Incident details -->
          <div class="bg-yellow-50 rounded-lg p-4 mb-4 border border-yellow-200">
            <h3 class="text-sm font-bold text-gray-800 mb-3 flex items-center">
              <svg class="w-4 h-4 mr-2 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
              ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå
            </h3>
            <div class="mb-3">
              <label class="block text-gray-700 font-semibold mb-1 text-xs">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå *</label>
              <textarea required rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡πÄ‡∏ä‡πà‡∏ô ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏, ‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á, ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏"></textarea>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
              <div class="relative">
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏</label>
                <input type="text" id="locationInput" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà..." oninput="searchLocation(this.value)" autocomplete="off" />
                <div id="locationDropdown" class="hidden absolute z-10 w-full bg-white border border-gray-300 rounded-lg shadow-lg mt-1 max-h-40 overflow-y-auto"></div>
              </div>
              <div>
                <label class="block text-gray-700 font-semibold mb-1 text-xs">‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</label>
                <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" />
              </div>
            </div>
          </div>

          <div class="flex gap-3">
            <button type="button" onclick="goBack()" class="px-4 py-3 border-2 border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50 text-sm">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
            <button type="submit" id="submitBtn" class="flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold py-3 px-4 rounded-lg shadow-lg hover:shadow-xl text-sm">‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚Üí</button>
          </div>
        </form>
      </div>
    </section>

    <!-- Step 5: Success -->
    <section id="successStep" class="hidden fade-in max-w-md mx-auto">
      <div class="bg-white rounded-2xl shadow-xl p-8 text-center">
        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-800 mb-2">‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h2>
        <p class="text-gray-600 mb-6">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß<br />HRBP ‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</p>
        <div class="bg-blue-50 rounded-lg p-4 mb-6"><p class="text-sm text-blue-800">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: <span class="font-bold" id="referenceNumber">HR-2025-001</span></p></div>
        <button onclick="resetForm()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏´‡∏°‡πà</button>
      </div>
    </section>
  </main>

  <!-- History Page -->
  <section id="historyPage" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent mb-2">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</h1>
      <p class="text-gray-600">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
    </div>

    <!-- Login -->
    <div id="historyLoginSection" class="bg-white rounded-2xl shadow-xl p-8 mb-8">
      <div class="text-center mb-6">
        <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </div>
        <h3 class="text-2xl font-bold text-gray-800 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</h3>
        <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå</p>
      </div>
      <form onsubmit="verifyHistoryAccess(event)" class="max-w-md mx-auto">
        <div class="mb-6">
          <label class="block text-gray-700 font-semibold mb-2 flex items-center justify-center">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
          <input type="text" id="historyEmployeeId" required class="w-full px-4 py-3 border-2 border-green-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 text-lg text-center" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 4 ‡∏´‡∏•‡∏±‡∏Å" />
          <div class="mt-2 p-3 bg-green-50 rounded-lg border border-green-200 text-center text-sm text-green-700">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ <strong>1234</strong></div>
        </div>
        <button type="submit" class="w-full px-6 py-3 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white font-bold rounded-xl shadow-lg">‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</button>
      </form>
    </div>

    <!-- History content -->
    <div id="historyContent" class="hidden">
      <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
        <div class="max-w-md mx-auto">
          <label class="block text-gray-700 font-semibold mb-3 text-center">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ñ‡∏™</label>
          <div class="flex gap-3">
            <input type="text" id="caseSearch" class="flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 text-lg" placeholder="‡πÄ‡∏ä‡πà‡∏ô HR-2025-001" />
            <button onclick="searchByCase()" class="px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 font-semibold">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
          </div>
        </div>
      </div>
      <div id="searchResults" class="hidden">
        <h3 class="text-2xl font-bold text-gray-800 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
        <div id="resultsContainer" class="space-y-4"></div>
      </div>

      <div class="bg-white rounded-2xl shadow-xl p-8">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800">‡πÄ‡∏Ñ‡∏™‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h3>
          <button onclick="logoutHistory()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
        <!-- renderer ‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏•‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ -->
        <div class="space-y-4"></div>
      </div>
    </div>
  </section>

  <!-- Dashboard Page (static demo) -->
  <section id="dashboardPage" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="text-center mb-10">
      <div class="w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl">
        <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2z"/></svg>
      </div>
      <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2">Dashboard</h1>
      <p class="text-gray-600">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-10">
      <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl shadow-xl p-8 border border-blue-200 text-center">
        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
        </div>
        <p class="text-4xl font-black text-gray-800 mb-2">24</p>
        <p class="text-blue-700 font-semibold">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
        <p class="text-blue-600 text-sm">Total Reports</p>
      </div>
      <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-2xl shadow-xl p-8 border border-red-200 text-center">
        <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01M5.062 19h13.876"/></svg>
        </div>
        <p class="text-4xl font-black text-gray-800 mb-2">8</p>
        <p class="text-red-700 font-semibold">‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å</p>
        <p class="text-red-600 text-sm">Critical Priority</p>
      </div>
      <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl shadow-xl p-8 border border-orange-200 text-center">
        <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
        </div>
        <p class="text-4xl font-black text-gray-800 mb-2">5</p>
        <p class="text-orange-700 font-semibold">‡∏î‡πà‡∏ß‡∏ô</p>
        <p class="text-orange-600 text-sm">High Priority</p>
      </div>
      <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl shadow-xl p-8 border border-green-200 text-center">
        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
        </div>
        <p class="text-4xl font-black text-gray-800 mb-2">11</p>
        <p class="text-green-700 font-semibold">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</p>
        <p class="text-green-600 text-sm">Medium Priority</p>
      </div>
    </div>

    <!-- Factory tiles (static demo) -->
    <div class="bg-white rounded-3xl shadow-2xl p-10 border border-gray-100">
      <div class="text-center mb-8">
        <h3 class="text-2xl font-bold text-gray-800">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô/‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</h3>
        <p class="text-gray-600">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô (‡πÄ‡∏î‡πÇ‡∏°)</p>
      </div>
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
        <button onclick="viewFactoryDetails('ladkrabang')" class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 border border-blue-200 hover:shadow-lg">‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á ‚Ä¢ 9</button>
        <button onclick="viewFactoryDetails('bangna')" class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border border-green-200 hover:shadow-lg">‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ ‚Ä¢ 6</button>
        <button onclick="viewFactoryDetails('samutprakarn')" class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 border border-purple-200 hover:shadow-lg">‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ ‚Ä¢ 4</button>
        <button onclick="viewFactoryDetails('chonburi')" class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4 border border-orange-200 hover:shadow-lg">‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ ‚Ä¢ 3</button>
        <button onclick="viewFactoryDetails('headquarters')" class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 border border-gray-200 hover:shadow-lg">‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà ‚Ä¢ 2</button>
      </div>
    </div>
  </section>

  <!-- Employee Login Modal -->
  <div id="employeeModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4">
      <div class="text-center mb-6">
        <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
        </div>
        <h3 class="text-xl font-bold text-gray-800 mb-1">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á</h3>
        <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</p>
      </div>
      <form onsubmit="verifyEmployee(event)">
        <div class="mb-6">
          <label class="block text-gray-700 font-semibold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label>
          <input type="text" id="employeeId" required class="w-full px-4 py-3 border-2 border-blue-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô 4 ‡∏´‡∏•‡∏±‡∏Å" />
          <div class="mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200 text-sm text-blue-700">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ <strong>1234</strong></div>
        </div>
        <div class="flex gap-3">
          <button type="button" onclick="closeEmployeeModal()" class="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-bold rounded-xl shadow-lg">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</button>
        </div>
      </form>
    </div>
  </div>

  <!-- HRBP Login Modal -->
  <div id="hrbpModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4">
      <div class="text-center mb-6">
        <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/></svg>
        </div>
        <h3 class="text-xl font-bold text-gray-800 mb-1">HRBP Monitor</h3>
        <p class="text-gray-600">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö HRBP</p>
      </div>
      <form onsubmit="verifyHRBP(event)">
        <div class="mb-6">
          <label class="block text-gray-700 font-semibold mb-2">‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô HRBP</label>
          <input type="text" id="hrbpId" required class="w-full px-4 py-3 border-2 border-purple-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-lg text-center" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô HRBP" />
          <div class="mt-2 p-3 bg-purple-50 rounded-lg border border-purple-200 text-sm text-purple-700 text-center">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ <strong>HRBP001</strong></div>
        </div>
        <div class="flex gap-3">
          <button type="button" onclick="closeHRBPModal()" class="flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 font-semibold rounded-xl hover:bg-gray-50">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button type="submit" class="flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800 text-white font-bold rounded-xl shadow-lg">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Case Detail Modal -->
  <div id="caseModal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-2xl p-8 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
      <div class="flex items-center justify-between mb-6">
        <h3 class="text-xl font-bold text-gray-800" id="caseTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏Ñ‡∏™</h3>
        <button onclick="closeCaseModal()" class="text-gray-500 hover:text-gray-700" aria-label="‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>
      <div id="caseContent" class="space-y-4 mb-8"></div>
      <div class="flex gap-3">
        <button onclick="closeCaseModal()" class="flex-1 px-6 py-3 border border-gray-300 text-gray-700 font-semibold rounded-lg hover:bg-gray-50">‡∏õ‡∏¥‡∏î</button>
      </div>
    </div>
  </div>

  <!-- ========= API URL + HELPERS (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏° Apps Script) ========= -->
  <script>
    // üîó ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô Web App URL (Deploy ‚Üí Test deployments ‚Üí /exec)
    const API_URL = 'https://script.google.com/macros/s/AKfycbz1whkbxKCJfjz1z0MxqFqeolY5nxvig0SV62QAi2Jz-CNjJRh9c0_ubxPIwzImu804Yw/exec';

    async function apiGet(params) {
      const url = API_URL + '?' + new URLSearchParams(params).toString();
      const res = await fetch(url, { method:'GET' });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }

    async function apiPost(payload) {
      const res = await fetch(API_URL, {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(payload)
      });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      return res.json();
    }
  </script>

  <!-- ========= APP SCRIPT / UI LOGIC ========= -->
  <script>
    // ===== Global state =====
    let currentStep = 1;
    let selectedCategory = '';
    let selectedSubCategory = '';
    let currentPage = 'report';
    let isHRBPLoggedIn = false;
    let isHistoryLoggedIn = false;

    // ===== Sub-categories =====
    const subCategories = {
      termination: [
        { id: 'resignation', name: '‡∏•‡∏≤‡∏≠‡∏≠‡∏Å', icon: 'üìù', desc: '‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏•‡∏≤‡∏≠‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á' },
        { id: 'dismissal',  name: '‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á', icon: '‚ùå', desc: '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô' },
        { id: 'transfer',   name: '‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢', icon: 'üîÑ', desc: '‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏Å/‡∏™‡∏≤‡∏Ç‡∏≤' },
        { id: 'retirement', name: '‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì', icon: 'üë¥', desc: '‡πÄ‡∏Å‡∏©‡∏µ‡∏¢‡∏ì‡∏≠‡∏≤‡∏¢‡∏∏‡∏£‡∏≤‡∏ä‡∏Å‡∏≤‡∏£' }
      ],
      accident: [
        { id: 'injury',   name: '‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö',   icon: 'ü©π', desc: '‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö' },
        { id: 'cut',      name: '‡∏°‡∏µ‡∏î‡∏ö‡∏≤‡∏î',   icon: 'üî™', desc: '‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏°' },
        { id: 'electric', name: '‡πÑ‡∏ü‡∏ä‡πá‡∏≠‡∏ï',   icon: '‚ö°', desc: '‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏î‡∏π‡∏î/‡∏ä‡πá‡∏≠‡∏ï' },
        { id: 'fall',     name: '‡∏•‡πâ‡∏°‡∏´‡∏Å‡∏•‡πâ‡∏°', icon: 'ü§ï', desc: '‡∏•‡πâ‡∏° ‡∏´‡∏Å‡∏•‡πâ‡∏° ‡∏ï‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á' },
        { id: 'burn',     name: '‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ',   icon: 'üî•', desc: '‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ ‡∏´‡∏£‡∏∑‡∏≠ ‡∏ñ‡∏π‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏ô' },
        { id: 'chemical', name: '‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ',  icon: '‚ò£Ô∏è', desc: '‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢' }
      ],
      safety: [
        { id: 'equipment',  name: '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô',      icon: 'ü¶∫', desc: '‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' },
        { id: 'procedure',  name: '‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥',       icon: 'üìã', desc: '‡πÑ‡∏°‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô' },
        { id: 'environment',name: '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°',         icon: 'üè≠', desc: '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' }
      ],
      complaint: [
        { id: 'harassment',    name: '‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏ß‡∏á‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î',            icon: 'üö´', desc: '‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏ß‡∏á‡∏•‡∏∞‡πÄ‡∏°‡∏¥‡∏î‡∏ó‡∏≤‡∏á‡πÄ‡∏û‡∏®/‡∏Ñ‡∏≥‡∏û‡∏π‡∏î' },
        { id: 'discrimination',name: '‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥',          icon: '‚öñÔ∏è', desc: '‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°' },
        { id: 'workplace',     name: '‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô',      icon: 'üè¢', desc: '‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' },
        { id: 'management',    name: '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£',                icon: 'üëî', desc: '‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£/‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏≤' }
      ]
    };

    // ===== Page router =====
    function showPage(page) {
      currentPage = page;
      document.getElementById('reportPage').classList.add('hidden');
      document.getElementById('historyPage').classList.add('hidden');
      document.getElementById('dashboardPage').classList.add('hidden');
      if (page === 'report')      document.getElementById('reportPage').classList.remove('hidden');
      else if (page === 'history')document.getElementById('historyPage').classList.remove('hidden');
      else if (page === 'dashboard') document.getElementById('dashboardPage').classList.remove('hidden');
    }

    // ===== Employee login (for proceeding to details) =====
    function showEmployeeLogin(){ document.getElementById('employeeModal').classList.remove('hidden'); }
    function closeEmployeeModal(){ document.getElementById('employeeModal').classList.add('hidden'); }
    function verifyEmployee(e){
      e.preventDefault();
      const id = document.getElementById('employeeId').value.trim();
      if (id === '1234'){ closeEmployeeModal(); proceedToDetails(); }
      else alert('‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
    }

    // ===== Category & Sub-category =====
    function selectCategory(category){
      selectedCategory = category;
      const names = { termination:'‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á', accident:'‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏', safety:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢', complaint:'‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' };
      document.getElementById('subCategoryTitle').textContent = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó${names[category]}`;
      showSubCategories(category);
      document.getElementById('categoryStep').classList.add('hidden');
      document.getElementById('subCategoryStep').classList.remove('hidden');
      document.getElementById('step2').classList.remove('active');
      document.getElementById('step2').classList.add('completed');
      document.getElementById('step3').classList.add('active');
      currentStep = 3;
    }
    function showSubCategories(category){
      const container = document.getElementById('subCategoryCards');
      container.innerHTML = '';
      (subCategories[category]||[]).forEach(sub => {
        const card = document.createElement('button');
        card.type = 'button';
        card.className = 'card-hover bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl p-6 border border-blue-100 hover:border-blue-300 hover:shadow-2xl';
        card.innerHTML = `<div class="text-center"><div class="text-4xl mb-4">${sub.icon}</div><h3 class="text-lg font-bold text-gray-800 mb-2">${sub.name}</h3><p class="text-sm text-gray-600">${sub.desc}</p></div>`;
        card.onclick = () => selectSubCategory(sub.id);
        container.appendChild(card);
      });
    }
    function selectSubCategory(subId){ selectedSubCategory = subId; showEmployeeLogin(); }

    // ===== Details step =====
    function proceedToDetails(){
      const names = { termination:'‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á', accident:'‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏', safety:'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢', complaint:'‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô' };
      const icons = {
        termination:'bg-gradient-to-br from-red-400 to-red-600',
        accident:'bg-gradient-to-br from-orange-400 to-orange-600',
        safety:'bg-gradient-to-br from-yellow-400 to-yellow-600',
        complaint:'bg-gradient-to-br from-purple-400 to-purple-600'
      };
      const subData = (subCategories[selectedCategory]||[]).find(s=>s.id===selectedSubCategory);
      const subName = subData? subData.name : '';
      document.getElementById('formTitle').textContent = `‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î${names[selectedCategory]} - ${subName}`;
      document.getElementById('formSubtitle').textContent = `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö${subName}‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô`;
      const iconBox = document.getElementById('priorityIcon');
      iconBox.className = `w-12 h-12 rounded-2xl mr-3 shadow-lg ${icons[selectedCategory]}`;

      // Date/time default in Asia/Bangkok
      const now = new Date();
      const dateStr = new Intl.DateTimeFormat('en-CA', { timeZone:'Asia/Bangkok' }).format(now); // yyyy-mm-dd
      const timeStr = new Intl.DateTimeFormat('en-GB', { hour: '2-digit', minute: '2-digit', hour12:false, timeZone:'Asia/Bangkok' }).format(now); // HH:mm
      document.getElementById('reportDate').value = dateStr;
      document.getElementById('reportTime').value = timeStr;

      document.getElementById('subCategoryStep').classList.add('hidden');
      document.getElementById('detailsStep').classList.remove('hidden');
      document.getElementById('step3').classList.remove('active');
      document.getElementById('step3').classList.add('completed');
      document.getElementById('step4').classList.add('active');
      currentStep = 4;
    }

    function goBackToCategory(){
      document.getElementById('subCategoryStep').classList.add('hidden');
      document.getElementById('categoryStep').classList.remove('hidden');
      document.getElementById('step3').classList.add('active');
    }

    function toggleDateEdit(){
      const el = document.getElementById('reportDate');
      const btn = document.getElementById('editDateBtn');
      el.readOnly = !el.readOnly;
      el.classList.toggle('cursor-not-allowed');
      el.classList.toggle('bg-yellow-50');
      btn.textContent = el.readOnly ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç' : '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
    }
    function toggleTimeEdit(){
      const el = document.getElementById('reportTime');
      const btn = document.getElementById('editTimeBtn');
      el.readOnly = !el.readOnly;
      el.classList.toggle('cursor-not-allowed');
      el.classList.toggle('bg-yellow-50');
      btn.textContent = el.readOnly ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç' : '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
    }

    function nextStep(){
      const ids = ['introStep','categoryStep','subCategoryStep','detailsStep','successStep'];
      document.getElementById(ids[currentStep-1]).classList.add('hidden');
      if(currentStep <= 4){
        const step = document.getElementById(`step${currentStep}`);
        step.classList.remove('active');
        step.classList.add('completed');
      }
      currentStep++;
      document.getElementById(ids[currentStep-1]).classList.remove('hidden');
      if(currentStep <= 4){ document.getElementById(`step${currentStep}`).classList.add('active'); }
      if(currentStep === 2){
        document.getElementById('categoryStep').classList.remove('hidden');
      }
    }

    function goBack(){
      if(currentStep === 4){
        document.getElementById('detailsStep').classList.add('hidden');
        document.getElementById('subCategoryStep').classList.remove('hidden');
        document.getElementById('step4').classList.remove('active');
        document.getElementById('step3').classList.remove('completed');
        document.getElementById('step3').classList.add('active');
        currentStep = 3;
        return;
      }
      const ids = ['introStep','categoryStep','subCategoryStep','detailsStep','successStep'];
      document.getElementById(ids[currentStep-1]).classList.add('hidden');
      if(currentStep <= 4){ document.getElementById(`step${currentStep}`).classList.remove('active'); }
      currentStep--;
      if(currentStep <= 4){
        const step = document.getElementById(`step${currentStep}`);
        step.classList.remove('completed');
        step.classList.add('active');
      }
      document.getElementById(ids[currentStep-1]).classList.remove('hidden');
    }

    // ===== SUBMIT: ‡∏™‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ Google Sheet ‡∏ú‡πà‡∏≤‡∏ô Apps Script =====
    async function submitReport(e){
      e.preventDefault();

      const payload = {
        action: 'create',
        Category: (selectedCategory || '').trim(),
        SubCategory: (selectedSubCategory || '').trim(),
        Detail: document.querySelector('#detailsStep textarea')?.value?.trim() || '',
        Location: document.getElementById('locationInput')?.value?.trim() || '',
        EmpId: document.getElementById('employeeCode')?.value?.trim() || '1234',
        EmpName: document.getElementById('employeeName')?.value?.trim() || '',
        Dept: document.getElementById('employeeDept')?.value?.trim() || '',
        Phone: document.getElementById('employeePhone')?.value?.trim() || ''
      };

      const btn = document.getElementById('submitBtn');
      btn.disabled = true; btn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á...';

      try{
        const result = await apiPost(payload);
        if(!result.ok) throw new Error(result.error || '‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');

        document.getElementById('referenceNumber').textContent = result.caseId;

        document.getElementById('detailsStep').classList.add('hidden');
        document.getElementById('successStep').classList.remove('hidden');
        document.getElementById('step4').classList.remove('active');
        currentStep = 5;
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
      }finally{
        btn.disabled = false; btn.textContent = '‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚Üí';
      }
    }

    function resetForm(){
      currentStep = 1; selectedCategory=''; selectedSubCategory='';
      const ids = ['introStep','categoryStep','subCategoryStep','detailsStep','successStep'];
      ids.forEach((id, i)=>{
        const el = document.getElementById(id);
        if(i===0) el.classList.remove('hidden'); else el.classList.add('hidden');
        if(i < 4){ const st = document.getElementById(`step${i+1}`); st.classList.remove('active','completed'); }
      });
      document.getElementById('step1').classList.add('active');
      document.querySelectorAll('form').forEach(f=>f.reset());
      showPage('report');
    }

    // ===== HRBP login & demo dashboard =====
    function showHRBPLogin(){ document.getElementById('hrbpModal').classList.remove('hidden'); }
    function closeHRBPModal(){ document.getElementById('hrbpModal').classList.add('hidden'); }
    function verifyHRBP(e){
      e.preventDefault();
      const id = document.getElementById('hrbpId').value.trim().toUpperCase();
      if(id==='HRBP001' || id==='ADMIN'){ isHRBPLoggedIn = true; closeHRBPModal(); alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö HRBP (‡πÄ‡∏î‡πÇ‡∏°)'); }
      else alert('‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô HRBP ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n\n‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö: ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™ HRBP001');
    }

    function viewFactoryDetails(factoryId){ showHRBPLogin(); window.selectedFactory=factoryId; }

    // ===== History (‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏à‡∏£‡∏¥‡∏á) =====
    async function verifyHistoryAccess(e){
      e.preventDefault();
      const id = document.getElementById('historyEmployeeId').value.trim();
      if(!id){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô'); return; }

      try{
        const result = await apiGet({ action:'listByEmp', empId: id });
        if(!result.ok) throw new Error(result.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');

        isHistoryLoggedIn = true;
        document.getElementById('historyLoginSection').classList.add('hidden');
        document.getElementById('historyContent').classList.remove('hidden');

        renderLatestCases_(result.rows || []);
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
      }
    }

    function logoutHistory(){
      isHistoryLoggedIn = false;
      document.getElementById('historyLoginSection').classList.remove('hidden');
      document.getElementById('historyContent').classList.add('hidden');
      document.getElementById('historyEmployeeId').value = '';
      document.getElementById('searchResults').classList.add('hidden');
    }

    function renderLatestCases_(rows){
      const wrap = document.querySelector('#historyContent .space-y-4');
      if(!wrap) return;
      wrap.innerHTML = '';

      rows.slice(0, 5).forEach(r => {
        const typeColor = r.Category === '‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á' ? 'red'
                        : r.Category === '‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏' ? 'orange'
                        : r.Category === '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢' ? 'yellow'
                        : 'purple';

        const statusPill = r.Status === '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô'
          ? `<span class="px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full">‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</span>`
          : `<span class="px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span>`;

        const card = document.createElement('div');
        card.className = `bg-gradient-to-r from-${typeColor}-50 to-${typeColor}-100 rounded-xl p-6 border-l-4 border-${typeColor}-500`;
        card.innerHTML = `
          <div class="flex justify-between items-start">
            <div>
              <h4 class="text-lg font-bold text-gray-800 mb-2">${r.CaseId} - ${r.Category}</h4>
              <p class="text-gray-600 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏¢‡πà‡∏≠‡∏¢: ${r.SubCategory || '-'} | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${r.Timestamp || '-'}</p>
              <p class="text-sm text-gray-500">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${r.Detail || '-'}</p>
            </div>
            <div class="flex flex-col gap-2">
              ${statusPill}
              <button onclick="viewCaseHistory('${r.CaseId}')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
              ${r.Status !== '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' ? `<button onclick="closeCaseByEmployee('${r.CaseId}')" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm">‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™</button>` : ''}
            </div>
          </div>`;
        wrap.appendChild(card);
      });
    }

    async function searchByCase(){
      const caseId = document.getElementById('caseSearch').value.trim();
      if(!caseId){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏Ñ‡∏™'); return; }

      try{
        const result = await apiGet({ action:'getById', caseId });
        if(!result.ok) throw new Error(result.error || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏Ñ‡∏™');

        const r = result.data;
        const rows = [{
          id: r.CaseId,
          type: `${r.Category} - ${r.SubCategory || ''}`.trim(),
          date: r.Timestamp || '',
          status: r.Status || '',
          employee: `${r.EmpName || ''} (${r.EmpId || ''})`,
          details: r.Detail || ''
        }];
        showSearchResults(rows);
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
      }
    }

    function showSearchResults(rows){
      const wrap = document.getElementById('resultsContainer');
      const box  = document.getElementById('searchResults');
      wrap.innerHTML = '';
      rows.forEach(r => {
        const statusColor = r.status==='‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' ? 'green' : 'yellow';
        const typeColor = r.type.includes('‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á') ? 'red' : r.type.includes('‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏') ? 'orange' : r.type.includes('‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢') ? 'yellow' : 'purple';
        const card = document.createElement('div');
        card.className = `bg-gradient-to-r from-${typeColor}-50 to-${typeColor}-100 rounded-xl p-6 border-l-4 border-${typeColor}-500`;
        card.innerHTML = `
          <div class="flex justify-between items-start">
            <div>
              <h4 class="text-lg font-bold text-gray-800 mb-2">${r.id} - ${r.type}</h4>
              <p class="text-gray-600 mb-2">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô: ${r.employee} | ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${r.date}</p>
              <p class="text-sm text-gray-500">${r.details}</p>
            </div>
            <div class="flex flex-col gap-2">
              <span class="px-3 py-1 bg-${statusColor}-100 text-${statusColor}-800 text-sm rounded-full">${r.status}</span>
              <button onclick="viewCaseHistory('${r.id}')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</button>
              ${r.status!=='‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô' ? `<button onclick=\"closeCaseByEmployee('${r.id}')\" class=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 text-sm\">‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™</button>` : ''}
            </div>
          </div>`;
        wrap.appendChild(card);
      });
      box.classList.remove('hidden');
    }

    async function closeCaseByEmployee(id){
      if(!confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™ ${id} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) return;
      try{
        const result = await apiPost({ action:'close', caseId: id });
        if(!result.ok) throw new Error(result.error || '‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        alert(`‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™ ${id} ‡πÅ‡∏•‡πâ‡∏ß`);
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
      }
    }

    async function viewCaseHistory(caseId){
      try{
        const result = await apiGet({ action:'getById', caseId });
        if(!result.ok) throw new Error(result.error || '‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏Ñ‡∏™');
        const r = result.data;

        const title = document.getElementById('caseTitle');
        const content = document.getElementById('caseContent');
        const modal = document.getElementById('caseModal');

        title.textContent = `${r.CaseId} - ${r.Category}${r.SubCategory ? ' - ' + r.SubCategory : ''}`;
        content.innerHTML = `
          <div class="grid md:grid-cols-2 gap-4">
            <div><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${r.Status || '-'}</div>
            <div><strong>‡∏£‡∏∞‡∏î‡∏±‡∏ö:</strong> <span class="px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">${inferPriority_(r.Category) || '‚Äî'}</span></div>
            <div><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà:</strong> ${r.Location || '-'}</div>
            <div><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${r.Timestamp || '-'}</div>
            <div><strong>‡πÄ‡∏ß‡∏•‡∏≤:</strong> ${extractTime_(r.Timestamp) || '-'}</div>
            <div><strong>‡∏ú‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á:</strong> ${r.EmpName || '-'} (${r.EmpId || '-'})</div>
          </div>
          <div class="mt-4"><strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong><p class="mt-2 p-4 bg-gray-50 rounded-lg">${r.Detail || '-'}</p></div>
        `;
        modal.classList.remove('hidden');
      }catch(err){
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message);
      }
    }
    function closeCaseModal(){ document.getElementById('caseModal').classList.add('hidden'); }

    // ===== Location quick search (demo list) =====
    const locations = [
      '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï','‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ö‡∏£‡∏£‡∏à‡∏∏','‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏•‡∏≤‡∏î‡∏Å‡∏£‡∏∞‡∏ö‡∏±‡∏á - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
      '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï','‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ö‡∏≤‡∏á‡∏ô‡∏≤ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û',
      '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï','‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏∏‡∏ó‡∏£‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ö‡∏£‡∏£‡∏à‡∏∏',
      '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ú‡∏•‡∏¥‡∏ï','‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
      '‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ö‡∏±‡∏ç‡∏ä‡∏µ','‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•','‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏ç‡πà - ‡πÅ‡∏ú‡∏ô‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î',
      '‡∏•‡∏≤‡∏ô‡∏à‡∏≠‡∏î‡∏£‡∏ñ','‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° A','‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏° B','‡πÇ‡∏£‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£','‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ä‡∏±‡πâ‡∏ô 1','‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ä‡∏±‡πâ‡∏ô 2','‡∏ö‡∏±‡∏ô‡πÑ‡∏î‡∏´‡∏ô‡∏µ‡πÑ‡∏ü','‡∏•‡∏¥‡∏ü‡∏ï‡πå A','‡∏•‡∏¥‡∏ü‡∏ï‡πå B'
    ];
    function searchLocation(q){
      const dropdown = document.getElementById('locationDropdown');
      const input = document.getElementById('locationInput');
      if(!q){ dropdown.classList.add('hidden'); return; }
      const items = locations.filter(s=>s.toLowerCase().includes(q.toLowerCase()));
      if(items.length===0){ dropdown.classList.add('hidden'); return; }
      dropdown.innerHTML = '';
      items.forEach(loc => {
        const div = document.createElement('div');
        div.className = 'px-4 py-2 hover:bg-blue-50 cursor-pointer text-sm border-b border-gray-100 last:border-b-0';
        div.textContent = loc;
        div.onclick = () => { input.value = loc; dropdown.classList.add('hidden'); };
        dropdown.appendChild(div);
      });
      dropdown.classList.remove('hidden');
    }
    document.addEventListener('click', (e)=>{
      const dropdown = document.getElementById('locationDropdown');
      const input = document.getElementById('locationInput');
      if(dropdown && !dropdown.contains(e.target) && e.target!==input){ dropdown.classList.add('hidden'); }
    });

    // ===== Small utils =====
    function inferPriority_(category){
      if (!category) return '';
      if (/‡πÄ‡∏•‡∏¥‡∏Å‡∏à‡πâ‡∏≤‡∏á|‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô/.test(category)) return '‡∏î‡πà‡∏ß‡∏ô';
      if (/‡∏≠‡∏∏‡∏ö‡∏±‡∏ï‡∏¥‡πÄ‡∏´‡∏ï‡∏∏/.test(category)) return '‡∏î‡πà‡∏ß‡∏ô‡∏°‡∏≤‡∏Å';
      return '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á';
    }
    function extractTime_(timestamp){
      if (!timestamp) return '';
      const m = String(timestamp).match(/(\d{2}:\d{2}:\d{2})$/);
      return m ? m[1] : '';
    }

    // ===== Init =====
    showPage('report');
    console.log('[HR Incident] API_URL:', API_URL);
  </script>
</body>
</html>
